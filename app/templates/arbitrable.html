{% extends 'layout.html' %}

{% block body%}
    {% block header %}
      <div class="row">
        <div class="col">
          <h3>{% block title %}Arbitrable {{ arbitrable['id'] }}</h3><h6><a href="https://etherscan.io/address/{{ arbitrable['id'] }}">view on etherscan</a></h6>{% endblock %}
        </div>
      </div>
    {% endblock %}


    {% block content %}

    {%if network=='xdai'%}
    {% set reward_currency =  'xDai'  %}
    {%else%}
        {% set reward_currency =  'ETH'  %}
    {%endif%}

      <div class="row">
        <div class="col-lg-4">
            <div class="panel panel-info">
              <div class="panel-heading">
                  <h3 class="panel-title text-center">Fees Generated</h3>
              </div>
              <div class="panel-body text-center">
                {%if network == 'xdai'%}
                <h4>{{ "{:.2f}".format(arbitrable['ethFees']) }} {{ reward_currency }}</h4>
                {%else%}
                <h4>{{ "{:.3f}".format(arbitrable['ethFees']) }} {{ reward_currency }}</h4>
                {%endif%}
              </div>
            </div>
        </div>
        <div class="col-lg-4">
          <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title text-center">Fees Generated in USD</h3>
            </div>
            <div class="panel-body text-center" id="feesUSD">
              <h4>Loading data...</h4>
              <script type="text/javascript">
                let address = {{ arbitrable['id']|tojson }};
                console.log(address)
              </script>
              <script src="{{ url_for('static', filename='js/getArbitrableUSD.js') }}" type="module"></script>
            </div>
          </div>
      </div>
        <div class="col-lg-4">
          <div class="panel panel-info">
              <div class="panel-heading">
                  <h3 class="panel-title text-center">Disputes Created</h3>
              </div>
              <div class="panel-body text-center">
                <h4>{{arbitrable['disputesCount']}}</h4>
              </div>
          </div>
        </div>
      </div>
      
      <h2>Disputes Created</h2>
      <div class="mb-5">
        <table class="table table-bordered responsive table-sm table-condensed table-hover">
          <tr class="info"><td>Dispute</td><td>Creation Date</td><td>TxID</td></tr>
          {% for dispute in arbitrable['disputes']|sort(attribute='timestamp', reverse=True): %}
          {% if dispute['ruled']%}
          <tr class="success">
          {% else %}
          <tr>
          {% endif %}
            <td><a href={{ url_for('dispute', id= dispute['id'], network=network) }}>Dispute {{dispute['id']}}</a></td>
            <td>{{ dispute['startTime']|timestamp2datetime }}</td>
            <td><a href="https://etherscan.io/tx/{{ dispute['txid'] }}">{{dispute['txid']}}</a></td>
          </tr>
          {% endfor %}
        </table>
      </div>
  
      
  {% endblock %}
{% endblock %}
